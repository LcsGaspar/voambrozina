<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Vó Ambrosina</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>

<body>
  <div class="header">
    <i class="fas fa-chart-line"></i>
    <h1>Dashboard - Vó Ambrosina</h1>
  </div>

  <div class="container">
    <div class="filters-section">
      <form method="GET" action="{{ url_for('dashboard.show_dashboard') }}">
        <select name="ano" aria-label="Selecionar ano">
          <option value="">Todos os Anos</option>
          {% for ano in anos_disponiveis %}
            <option value="{{ ano }}" {% if ano_selecionado == ano|int %}selected{% endif %}>{{ ano }}</option>
          {% endfor %}
        </select>

        <select name="mes" aria-label="Selecionar mês">
          <option value="">Todos os Meses</option>
          <option value="1" {% if mes_selecionado == 1 %}selected{% endif %}>Janeiro</option>
          <option value="2" {% if mes_selecionado == 2 %}selected{% endif %}>Fevereiro</option>
          <option value="3" {% if mes_selecionado == 3 %}selected{% endif %}>Março</option>
          <option value="4" {% if mes_selecionado == 4 %}selected{% endif %}>Abril</option>
          <option value="5" {% if mes_selecionado == 5 %}selected{% endif %}>Maio</option>
          <option value="6" {% if mes_selecionado == 6 %}selected{% endif %}>Junho</option>
          <option value="7" {% if mes_selecionado == 7 %}selected{% endif %}>Julho</option>
          <option value="8" {% if mes_selecionado == 8 %}selected{% endif %}>Agosto</option>
          <option value="9" {% if mes_selecionado == 9 %}selected{% endif %}>Setembro</option>
          <option value="10" {% if mes_selecionado == 10 %}selected{% endif %}>Outubro</option>
          <option value="11" {% if mes_selecionado == 11 %}selected{% endif %}>Novembro</option>
          <option value="12" {% if mes_selecionado == 12 %}selected{% endif %}>Dezembro</option>
        </select>
        
        <button type="submit">Filtrar</button>
      </form>
    </div>

    {% if error %}
      <div class="error-message">{{ error }}</div>
    {% else %}
      {% if total_inscritos and total_inscritos > 0 %}
        <div class="cards">
          <div class="card">
            <i class="fas fa-users"></i>
            <h3>{{ total_inscritos }}</h3>
            <p>Total de Inscritos</p>
          </div>

          <div class="card">
            <i class="fas fa-book"></i>
            <h3>{{ oficinas|length }}</h3>
            <p>Total de Oficinas</p>
          </div>
        </div>

        <div class="dashboard-section">
          <h2>Distribuição por Oficina</h2>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Oficina</th>
                  <th>Quantidade</th>
                </tr>
              </thead>
              <tbody>
                {% for oficina, quantidade in oficinas.items() %}
                <tr>
                  <td>{{ oficina }}</td>
                  <td>{{ quantidade }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>

        <div class="dashboard-section">
          <h2>Distribuição por Faixa Etária</h2>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Faixa Etária</th>
                  <th>Quantidade</th>
                </tr>
              </thead>
              <tbody>
                {% for faixa, quantidade in faixas_etarias.items() %}
                <tr>
                  <td>{{ faixa }}</td>
                  <td>{{ quantidade }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>

        <div class="dashboard-section">
          <h2>Distribuição por Idade</h2>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Idade</th>
                  <th>Quantidade</th>
                </tr>
              </thead>
              <tbody>
                {% for idade, quantidade in distribuicao_idade.items()|sort %}
                <tr>
                  <td>{{ idade }} anos</td>
                  <td>{{ quantidade }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      {% else %}
        <div class="error-message">Não foram encontrados dados para os filtros selecionados.</div>
      {% endif %}
    {% endif %}
  </div>
</body>

</html>